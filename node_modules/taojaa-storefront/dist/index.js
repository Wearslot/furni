/*! For license information please see index.js.LICENSE.txt */
(()=>{var t={128:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var c=r(928),i=r(96),u=r(818),p=r(252),f=r(268),l=r(898),d=r(691);u.config();var h=r(671),v=r(451),y=v.storeMiddleware,m=v.themeMiddleware,g=v.trafficMiddleware,b=r(773).loadTemplate,w=r(962),x=r(584).password,k=r(760).bootstrap,_=p();_.use(i("dev")),_.use(p.json()),_.use(p.urlencoded({extended:!1})),_.use(p.static(process.env.THEME_DIR||c.join(__dirname,"".concat("development"===process.env.APP_ENV?"../themes-dev":"../themes")))),_.use(d({name:"session",keys:["taojaa"],maxAge:6e4,secure:"production"===process.env.APP_ENV})),_.use(l()),_.use(f.urlencoded({extended:!1})),_.use(f.json()),_.use("/password",k,y,x),_.use("/",k,y,m,g,h),_.use("*",k,y,m,(function(t,e,r){e.status(404);var n=b("404",a(a({},e.data),{},{title:"Page Not Found",page:"404"}));return e.send(n)})),_.use(k,y,w),t.exports=_},235:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(){"use strict";c=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,a=Object.defineProperty||function(t,e,r){t[e]=r.value},s="function"==typeof Symbol?Symbol:{},i=s.iterator||"@@iterator",u=s.asyncIterator||"@@asyncIterator",p=s.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,s=Object.create(o.prototype),c=new q(n||[]);return a(s,"_invoke",{value:S(t,r,c)}),s}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,i,(function(){return this}));var _=Object.getPrototypeOf,O=_&&_(_(D([])));O&&O!==r&&o.call(O,i)&&(k=O);var j=x.prototype=b.prototype=Object.create(k);function E(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(a,s,c,i){var u=d(t[a],t,s);if("throw"!==u.type){var p=u.arg,f=p.value;return f&&"object"==n(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,c,i)}),(function(t){r("throw",t,c,i)})):e.resolve(f).then((function(t){p.value=t,c(p)}),(function(t){return r("throw",t,c,i)}))}i(u.arg)}var s;a(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return s=s?s.then(o,o):o()}})}function S(e,r,n){var o=h;return function(a,s){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===a)throw s;return{value:t,done:!0}}for(n.method=a,n.arg=s;;){var c=n.delegate;if(c){var i=L(c,n);if(i){if(i===g)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var u=d(e,r,n);if("normal"===u.type){if(o=n.done?m:v,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=d(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var s=a.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function q(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var a=-1,s=function r(){for(;++a<e.length;)if(o.call(e,a))return r.value=e[a],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=x,a(j,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,p,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,p,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},E(P.prototype),f(P.prototype,u,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var s=new P(l(t,r,n,o),a);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},E(j),f(j,p,"Generator"),f(j,i,(function(){return this})),f(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,q.prototype={constructor:q,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var a=this.tryEntries.length-1;a>=0;--a){var s=this.tryEntries[a],c=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var i=o.call(s,"catchLoc"),u=o.call(s,"finallyLoc");if(i&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(i){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var s=a?a.completion:{};return s.type=t,s.arg=e,a?(this.method="next",this.next=a.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function i(t,e,r,n,o,a,s){try{var c=t[a](s),i=c.value}catch(t){return void r(t)}c.done?e(i):Promise.resolve(i).then(n,o)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,c,"next",t)}function c(t){i(a,n,o,s,c,"throw",t)}s(void 0)}))}}var p=r(979).newCartHashToken,f=r(773).loadComponent,l=r(157),d=l.apiPost,h=l.apiGet,v=function(t,e,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:200;return e.status(n),"application/json"!==t.header("Accept")?(t.session[r.status]=r.message,e.redirect(t.headers.referer)):e.json(r)},y=function(){var t=u(c().mark((function t(e,r){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.json(r.data.cart));case 1:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),m=function(){var t=u(c().mark((function t(e,r){var n,o,s,i,u,l,y,m;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=e.cookies.cart_id)||(n=p(),r.cookie("cart_id",n)),o=void 0!==e.body.components?JSON.parse(e.body.components):[],delete e.body.components,s=a(a({cart_id:n},e.body),{},{quantity:Number(e.body.quantity),product_id:Number(e.body.product_id),currency:e.currency.code}),t.next=8,d("/".concat(e.store.store_id,"/cart/add"),s);case 8:if("success"!==(i=t.sent).data.status){t.next=15;break}return t.next=12,h("/".concat(e.store.store_id,"/cart/").concat(e.cookies.cart_id));case 12:return u=t.sent,o.length>0&&(l=a(a({},r.data),{},{cart:u.data}),y={},m=a(a({},l),{},{item:i.data.data}),o.forEach((function(t){y[t]=f(t,m)})),i.data.data.components=y),t.abrupt("return",v(e,r,a({status:"success",message:"Item added to cart"},i.data.data)));case 15:return t.abrupt("return",v(e,r,{status:"error",message:"Unable to add item to cart"},400));case 18:if(t.prev=18,t.t0=t.catch(0),!t.t0.response){t.next=22;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message,error:t.t0.response.data},400));case 22:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 23:case"end":return t.stop()}}),t,null,[[0,18]])})));return function(e,r){return t.apply(this,arguments)}}(),g=function(){var t=u(c().mark((function t(e,r){var n,o,s,i,u,p,l,y;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=void 0!==e.body.components?JSON.parse(e.body.components):[],delete e.body.components,o=r.data.cart.items[Number(e.body.line)-1],s=a(a({},e.body),{},{quantity:Number(e.body.quantity),item_id:o.id,cart_id:r.data.cart.id}),t.next=7,d("/".concat(e.store.store_id,"/cart/update"),s);case 7:if("success"!==t.sent.data.status){t.next=15;break}return t.next=11,h("/".concat(e.store.store_id,"/cart/").concat(e.cookies.cart_id));case 11:return i=t.sent,u=i.data.items.find((function(t){return t.id===o.id})),n.length>0&&(p=a(a({},r.data),{},{cart:i.data}),l={},y=a(a({},p),{},{item:u||o}),n.forEach((function(t){l[t]=f(t,y)}))),t.abrupt("return",v(e,r,a(a({status:"success",message:"Cart updated successfully"},i.data),{},{item_id:u?u.id:o.id,components:l})));case 15:t.next=23;break;case 17:if(t.prev=17,t.t0=t.catch(0),console.log(t.t0),!t.t0.response){t.next=22;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message,error:t.t0.response.data},400));case 22:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 23:case"end":return t.stop()}}),t,null,[[0,17]])})));return function(e,r){return t.apply(this,arguments)}}(),b=function(){var t=u(c().mark((function t(e,r){var n,o,s,i,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=a(a({},e.body),{},{cart_id:e.cookies.cart_id}),o=void 0!==e.body.components?JSON.parse(e.body.components):[],delete e.body.components,t.next=6,d("/".concat(e.store.store_id,"/discount/apply"),n);case 6:if("success"!==t.sent.data.status){t.next=13;break}return t.next=10,h("/".concat(e.store.store_id,"/cart/").concat(e.cookies.cart_id));case 10:return s=t.sent,o.length>0&&(i=a(a({},r.data),{},{cart:s.data}),u={},o.forEach((function(t){u[t]=f(t,i)}))),t.abrupt("return",v(e,r,a(a({status:"success",message:"Discount applied successfully"},s.data),{},{components:u})));case 13:t.next=20;break;case 15:if(t.prev=15,t.t0=t.catch(0),!t.t0.response){t.next=19;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message,error:t.t0.response.data},400));case 19:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 20:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e,r){return t.apply(this,arguments)}}(),w=function(){var t=u(c().mark((function t(e,r){var n,o,s,i,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={cart_id:e.cookies.cart_id},o=void 0!==e.body.components?JSON.parse(e.body.components):[],delete e.body.components,t.next=6,d("/".concat(e.store.store_id,"/discount/remove"),n);case 6:if("success"!==t.sent.data.status){t.next=13;break}return t.next=10,h("/".concat(e.store.store_id,"/cart/").concat(e.cookies.cart_id));case 10:return s=t.sent,o.length>0&&(i=a(a({},r.data),{},{cart:s.data}),u={},o.forEach((function(t){u[t]=f(t,i)}))),t.abrupt("return",v(e,r,a(a({status:"success",message:"Discount removed successfully"},s.data),{},{components:u})));case 13:t.next=20;break;case 15:if(t.prev=15,t.t0=t.catch(0),!t.t0.response){t.next=19;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message,error:t.t0.response.data},400));case 19:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 20:case"end":return t.stop()}}),t,null,[[0,15]])})));return function(e,r){return t.apply(this,arguments)}}(),x=function(){var t=u(c().mark((function t(e,r){var n,o,s,i,u;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n=void 0!==e.body.components?JSON.parse(e.body.components):[],delete e.body.components,o="/".concat(e.store.store_id,"/product/").concat(e.body.slug,"?currency=").concat(e.cookies.currency),t.next=6,h(o);case 6:if(!(s=t.sent).data.data){t.next=10;break}return n.length>0&&(i=a(a({},r.data),{},{product:s.data.data}),u={},n.forEach((function(t){u[t]=f(t,i)}))),t.abrupt("return",v(e,r,a(a({status:"success",message:"Data fetched successfully"},s.data.data),{},{components:u})));case 10:t.next=17;break;case 12:if(t.prev=12,t.t0=t.catch(0),!t.t0.response){t.next=16;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message,error:t.t0.response.data},400));case 16:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r){return t.apply(this,arguments)}}(),k=function(){var t=u(c().mark((function t(e,r){var n,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={email:e.body.email},t.next=4,d("/".concat(e.store.store_id,"/subscribe-newsletter"),n);case 4:if("success"!==(o=t.sent).data.status){t.next=7;break}return t.abrupt("return",v(e,r,{status:"success",message:o.data.message}));case 7:t.next=14;break;case 9:if(t.prev=9,t.t0=t.catch(0),!t.t0.response){t.next=13;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message,error:t.t0.response.data},400));case 13:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 14:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,r){return t.apply(this,arguments)}}(),_=function(){var t=u(c().mark((function t(e,r){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.store.email){t.next=3;break}return t.abrupt("return",v(e,r,{status:"error",message:"Cannot receive emails at the moment"},400));case 3:return n={from:e.body.email,to:e.store.email,subject:"Contact Message From - "+e.body.name,text:e.body.message},t.next=6,d("".concat(e.store.store_id,"/send-contact-message"),n);case 6:if("success"!==t.sent.data.status){t.next=9;break}return t.abrupt("return",v(e,r,{status:"success",message:"Message has been sent successfully"}));case 9:return t.abrupt("return",v(e,r,{status:"error",message:"Error sending message, please try again later."},400));case 12:if(t.prev=12,t.t0=t.catch(0),!t.t0.response){t.next=16;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message,error:t.t0.response.data},400));case 16:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r){return t.apply(this,arguments)}}(),O=function(){var t=u(c().mark((function t(e,r){var n,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={product_id:e.body.product_id,fullname:e.body.fullname,email:e.body.email,rate:Number(e.body.rate),message:e.body.message},t.next=4,d("/".concat(e.store.store_id,"/reviews"),n);case 4:if(!(o=t.sent).data||"success"!==o.data.status){t.next=9;break}return t.abrupt("return",v(e,r,{status:"success",message:o.data.message}));case 9:return t.abrupt("return",v(e,r,{status:"error",message:o.data.message||"Failed to create review"},400));case 10:t.next=17;break;case 12:if(t.prev=12,t.t0=t.catch(0),!t.t0.response||!t.t0.response.body){t.next=16;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.body.message},400));case 16:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r){return t.apply(this,arguments)}}(),j=function(){var t=u(c().mark((function t(e,r){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("".concat(process.env.MARKETING_SERVICE,"/datafeed/").concat(e.params.slug,"?store_id=").concat(e.store.id));case 3:return n=t.sent,t.abrupt("return",r.header("Content-Type","application/xml").send('<?xml version="1.0" encoding="UTF-8"?>'.concat(n.data)));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",r.status(500).json({error:t.t0}));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,r){return t.apply(this,arguments)}}(),E=function(){var t=u(c().mark((function t(e,r){var n,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={email:e.body.email,password:e.body.password},t.next=4,d("/".concat(e.store.store_id,"/customers/account/login"),n);case 4:if(!(o=t.sent).data||"success"!==o.data.status){t.next=9;break}return t.abrupt("return",v(e,r,{status:"success",message:o.data.message}));case 9:return t.abrupt("return",v(e,r,{status:"error",message:o.data.message||"Login Failed"},400));case 10:t.next=17;break;case 12:if(t.prev=12,t.t0=t.catch(0),!t.t0.response||!t.t0.response.data){t.next=16;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message},400));case 16:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r){return t.apply(this,arguments)}}(),P=function(){var t=u(c().mark((function t(e,r){var n,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={name:e.body.name,email:e.body.email,password:e.body.password,confirm_password:e.body.confirm_password},t.next=4,d("/".concat(e.store.store_id,"/customers/account/register"),n);case 4:if(!(o=t.sent).data||"success"!==o.data.status){t.next=9;break}return t.abrupt("return",v(e,r,{status:"success",message:o.data.message}));case 9:return t.abrupt("return",v(e,r,{status:"error",message:o.data.message||"Signup Failed"},400));case 10:t.next=17;break;case 12:if(t.prev=12,t.t0=t.catch(0),!t.t0.response||!t.t0.response.data){t.next=16;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message},400));case 16:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r){return t.apply(this,arguments)}}(),S=function(){var t=u(c().mark((function t(e,r){var n,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={email:e.body.email},t.next=4,d("/".concat(e.store.store_id,"/customers/account/forgot-password"),n);case 4:if(!(o=t.sent).data||"success"!==o.data.status){t.next=9;break}return t.abrupt("return",v(e,r,{status:"success",message:o.data.message}));case 9:return t.abrupt("return",v(e,r,{status:"error",message:o.data.message||"Password Recovery Failed"},400));case 10:t.next=18;break;case 12:if(t.prev=12,t.t0=t.catch(0),console.log(t.t0.response),!t.t0.response||!t.t0.response.data){t.next=17;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message},400));case 17:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 18:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r){return t.apply(this,arguments)}}(),L=function(){var t=u(c().mark((function t(e,r){var n,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={password:e.body.password,confirm_password:e.body.confirm_password},t.next=4,d("/".concat(e.store.store_id,"/customers/account/reset-password/").concat(e.params.id,"/").concat(e.params.token),n);case 4:if(!(o=t.sent).data||"success"!==o.data.status){t.next=9;break}return t.abrupt("return",v(e,r,{status:"success",message:o.data.message}));case 9:return t.abrupt("return",v(e,r,{status:"error",message:o.data.message||"Password Recovery Failed"},400));case 10:t.next=17;break;case 12:if(t.prev=12,t.t0=t.catch(0),!t.t0.response||!t.t0.response.data){t.next=16;break}return t.abrupt("return",v(e,r,{status:"error",message:t.t0.response.data.message},400));case 16:return t.abrupt("return",v(e,r,{status:"error",message:"Something went wrong",error:t.t0},500));case 17:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r){return t.apply(this,arguments)}}();t.exports={cartJson:y,addToCart:m,updateCart:g,applyDiscount:b,removeDiscount:w,quickView:x,newsletterSignup:k,contactForm:_,createProductReview:O,productsXMl:j,handleLogin:E,handleSignUp:P,handleForgotPassword:S,handleResetPassword:L}},584:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},i=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",p=c.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),c=new q(n||[]);return s(a,"_invoke",{value:S(t,r,c)}),a}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,i,(function(){return this}));var _=Object.getPrototypeOf,O=_&&_(_(D([])));O&&O!==r&&a.call(O,i)&&(k=O);var j=x.prototype=b.prototype=Object.create(k);function E(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(o,s,c,i){var u=d(t[o],t,s);if("throw"!==u.type){var p=u.arg,f=p.value;return f&&"object"==n(f)&&a.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,c,i)}),(function(t){r("throw",t,c,i)})):e.resolve(f).then((function(t){p.value=t,c(p)}),(function(t){return r("throw",t,c,i)}))}i(u.arg)}var o;s(this,"_invoke",{value:function(t,n){function a(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(a,a):a()}})}function S(e,r,n){var o=h;return function(a,s){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===a)throw s;return{value:t,done:!0}}for(n.method=a,n.arg=s;;){var c=n.delegate;if(c){var i=L(c,n);if(i){if(i===g)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var u=d(e,r,n);if("normal"===u.type){if(o=n.done?m:v,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=d(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var s=a.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function q(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(a.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=x,s(j,"constructor",{value:x,configurable:!0}),s(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,p,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,p,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},E(P.prototype),f(P.prototype,u,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var s=new P(l(t,r,n,o),a);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},E(j),f(j,p,"Generator"),f(j,i,(function(){return this})),f(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,q.prototype={constructor:q,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],c=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var i=a.call(s,"catchLoc"),u=a.call(s,"finallyLoc");if(i&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(i){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e,r,n,o,a,s){try{var c=t[a](s),i=c.value}catch(t){return void r(t)}c.done?e(i):Promise.resolve(i).then(n,o)}var u=r(896),p=r(157),f=p.apiPost,l=p.resolveDataRequest,d=r(292).renderUtilsPage;e.password=function(){var t,e=(t=o().mark((function t(e,r,n){var a,c,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=d("password"),"live"!==e.store.store_type){t.next=7;break}if(!u.existsSync("".concat(process.env.THEME_BASE_PATH,"templates/password.json"))){t.next=7;break}return t.next=5,l("password",e);case 5:c=t.sent,a=loadTemplate("password",s(s({},r.data),{},{title:"Password",current_page:"password"},c));case 7:if(t.prev=7,"POST"!==e.method){t.next=17;break}if(e.body.password){t.next=11;break}return t.abrupt("return",r.send(d("password",{error:"Password is required!"})));case 11:return t.next=13,f("/generate-storefront-token?domain=".concat(process.env.STORE_DOMAIN||e.get("host")),{password:e.body.password,store_id:e.store.store_id});case 13:if("success"!==(i=t.sent).data.status){t.next=17;break}return r.cookie("_sys_atj",i.data.token),t.abrupt("return",r.redirect("/"));case 17:return t.abrupt("return",r.send(a));case 20:if(t.prev=20,t.t0=t.catch(7),!t.t0.response){t.next=24;break}return t.abrupt("return",r.send(d("password",{error:t.t0.response.data.message})));case 24:n(t.t0);case 25:case"end":return t.stop()}}),t,null,[[7,20]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,c,"next",t)}function c(t){i(a,n,o,s,c,"throw",t)}s(void 0)}))});return function(t,r,n){return e.apply(this,arguments)}}()},629:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(){"use strict";o=function(){return e};var t,e={},r=Object.prototype,a=r.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},c="function"==typeof Symbol?Symbol:{},i=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",p=c.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),c=new q(n||[]);return s(a,"_invoke",{value:S(t,r,c)}),a}function d(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",v="suspendedYield",y="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,i,(function(){return this}));var _=Object.getPrototypeOf,O=_&&_(_(D([])));O&&O!==r&&a.call(O,i)&&(k=O);var j=x.prototype=b.prototype=Object.create(k);function E(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(o,s,c,i){var u=d(t[o],t,s);if("throw"!==u.type){var p=u.arg,f=p.value;return f&&"object"==n(f)&&a.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,c,i)}),(function(t){r("throw",t,c,i)})):e.resolve(f).then((function(t){p.value=t,c(p)}),(function(t){return r("throw",t,c,i)}))}i(u.arg)}var o;s(this,"_invoke",{value:function(t,n){function a(){return new e((function(e,o){r(t,n,e,o)}))}return o=o?o.then(a,a):a()}})}function S(e,r,n){var o=h;return function(a,s){if(o===y)throw Error("Generator is already running");if(o===m){if("throw"===a)throw s;return{value:t,done:!0}}for(n.method=a,n.arg=s;;){var c=n.delegate;if(c){var i=L(c,n);if(i){if(i===g)continue;return i}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var u=d(e,r,n);if("normal"===u.type){if(o=n.done?m:v,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=m,n.method="throw",n.arg=u.arg)}}}function L(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,L(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var a=d(o,e.iterator,r.arg);if("throw"===a.type)return r.method="throw",r.arg=a.arg,r.delegate=null,g;var s=a.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function q(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,s=function r(){for(;++o<e.length;)if(a.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=x,s(j,"constructor",{value:x,configurable:!0}),s(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,p,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,p,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},E(P.prototype),f(P.prototype,u,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,o,a){void 0===a&&(a=Promise);var s=new P(l(t,r,n,o),a);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},E(j),f(j,p,"Generator"),f(j,i,(function(){return this})),f(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,q.prototype={constructor:q,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&a.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],c=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var i=a.call(s,"catchLoc"),u=a.call(s,"finallyLoc");if(i&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(i){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){c(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function c(t,e,r){return(e=function(t){var e=function(t,e){if("object"!=n(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function i(t,e,r,n,o,a,s){try{var c=t[a](s),i=c.value}catch(t){return void r(t)}c.done?e(i):Promise.resolve(i).then(n,o)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function s(t){i(a,n,o,s,c,"next",t)}function c(t){i(a,n,o,s,c,"throw",t)}s(void 0)}))}}var p=r(896),f=r(773).loadTemplate,l=r(157),d=l.apiGet,h=l.resolveDataRequest,v=function(){var t=u(o().mark((function t(e,r,n){var a,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("home",e);case 3:return a=t.sent,c=f("home",s(s({},r.data),{},{title:"Home",current_page:"index"},a)),t.abrupt("return",r.send(c));case 8:t.prev=8,t.t0=t.catch(0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),y=function(){var t=u(o().mark((function t(e,r,n){var a,c,i,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("shop",e);case 3:if(a=t.sent,c=s(s({},r.data),{},{title:"Shop",current_page:"shop"},a),void 0!==a.products){t.next=10;break}return t.next=8,d("/".concat(e.store.store_id,"/products?per_page=20&page=").concat(e.query.page||1,"&currency=").concat(e.cookies.currency));case 8:i=t.sent,c=s(s({},c),{},{products:{data:i.data.data,pagination:i.data.pagination,filters:i.data.filters}});case 10:return u=f("shop",c),t.abrupt("return",r.send(u));case 14:t.prev=14,t.t0=t.catch(0),n(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,r,n){return t.apply(this,arguments)}}(),m=function(){var t=u(o().mark((function t(e,r,n){var a,c,i,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("collections",e);case 3:if(a=t.sent,c=s(s({},r.data),{},{title:"Collections",current_page:"collections"},a),void 0!==a.collections){t.next=10;break}return t.next=8,d("/".concat(e.store.store_id,"/collections?per_page=20&page=").concat(e.query.page||1));case 8:i=t.sent,c=s(s({},c),{},{collections:{data:i.data.data,pagination:i.data.pagination}});case 10:return u=f("collections",c),t.abrupt("return",r.send(u));case 14:t.prev=14,t.t0=t.catch(0),n(t.t0);case 17:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,r,n){return t.apply(this,arguments)}}(),g=function(){var t=u(o().mark((function t(e,r,n){var a,c,i,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("collection",e);case 3:return a=t.sent,t.next=6,d("/".concat(e.store.store_id,"/collection?slug=").concat(e.params.slug));case 6:return c=t.sent,i=s(s({},r.data),{},{title:c.data.data.name,current_page:"collection",collection:c.data.data},a),u=f("collection",i),t.abrupt("return",r.send(u));case 12:t.prev=12,t.t0=t.catch(0),n(t.t0);case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e,r,n){return t.apply(this,arguments)}}(),b=function(){var t=u(o().mark((function t(e,r,n){var a,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e.query.keywords){t.next=4;break}return r.cookie("errors",JSON.stringify({search:"Keywords cannot be empty"})),t.abrupt("return",r.redirect(e.headers.referer));case 4:return t.next=6,h("collection",e);case 6:return a=t.sent,c=f("search",data=s(s({},r.data),{},{title:"Shop",current_page:"search",keywords:e.query.keywords},a)),t.abrupt("return",r.send(c));case 11:t.prev=11,t.t0=t.catch(0),n(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,r,n){return t.apply(this,arguments)}}(),w=function(){var t=u(o().mark((function t(e,r,n){var a,c,i,u,p;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a="/".concat(e.store.store_id,"/product/").concat(e.params.slug,"?currency=").concat(e.cookies.currency),e.query.variant&&(a+="&variant=".concat(e.query.variant)),t.next=5,d(a);case 5:if(!(c=t.sent).data.data){t.next=15;break}return t.next=9,h("product",e);case 9:return i=t.sent,t.next=12,d("/".concat(e.store.store_id,"/products?similar_products=true&product_id=").concat(c.data.data.id,"&currency=").concat(e.cookies.currency));case 12:return u=t.sent,p=f("product",data=s(s({},r.data),{},{title:c.data.data.name,product:c.data.data,similar_products:u.data.data,current_page:"product-detail"},i)),t.abrupt("return",r.send(p));case 15:return p=f("404",data=s(s({},r.data),{},{title:"Product not found"})),t.abrupt("return",r.send(p));case 19:t.prev=19,t.t0=t.catch(0),n(t.t0);case 22:case"end":return t.stop()}}),t,null,[[0,19]])})));return function(e,r,n){return t.apply(this,arguments)}}(),x=function(){var t=u(o().mark((function t(e,r,n){var a,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("cart",e);case 3:return a=t.sent,c=f("cart",data=s(s({},r.data),{},{title:"Cart",current_page:"cart"},a)),t.abrupt("return",r.send(c));case 8:t.prev=8,t.t0=t.catch(0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),k=function(){var t=u(o().mark((function t(e,r,n){var a,c,i,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a="pages",p.existsSync("".concat(process.env.THEME_BASE_PATH,"templates/pages.").concat(e.params.name,".json"),"utf8")&&(a="pages.".concat(e.params.name)),t.next=5,h(a,e);case 5:return c=t.sent,t.next=8,d("/".concat(e.store.store_id,"/pages/").concat(e.params.name));case 8:return i=(i=t.sent).data.data,u=f(a,data=s(s({},r.data),{},{title:i.title,content:i.content,current_page:i.name.replace(/ /g,"-").toLowerCase()},c)),t.abrupt("return",r.send(u));case 14:if(t.prev=14,t.t0=t.catch(0),!t.t0.response){t.next=19;break}if("Page does not exist"!==t.t0.response.data.message){t.next=19;break}return t.abrupt("return",r.redirect("/not-found"));case 19:n(t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,14]])})));return function(e,r,n){return t.apply(this,arguments)}}(),_=function(){var t=u(o().mark((function t(e,r,n){var a,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("contact",e);case 3:return a=t.sent,c=f("contact",options=s(s({},r.data),{},{title:"Contact",current_page:"contact"},a)),t.abrupt("return",r.send(c));case 8:t.prev=8,t.t0=t.catch(0),n(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e,r,n){return t.apply(this,arguments)}}(),O=function(){var t=u(o().mark((function t(e,r,n){var a,c;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=e.params.order_no,c=f("order-placed",data=s(s({},r.data),{},{title:"Checkout Completed",order_no:a,current_page:"checkout-completed"})),t.abrupt("return",r.send(c));case 6:t.prev=6,t.t0=t.catch(0),n(t.t0);case 9:case"end":return t.stop()}}),t,null,[[0,6]])})));return function(e,r,n){return t.apply(this,arguments)}}(),j=function(){var t=u(o().mark((function t(e,r,n){var a,c,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("login",e);case 3:return a=t.sent,c=s(s({},r.data),{},{title:"Login",current_page:"login"},a),i=f("login",c),t.abrupt("return",r.send(i));case 9:t.prev=9,t.t0=t.catch(0),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,r,n){return t.apply(this,arguments)}}(),E=function(){var t=u(o().mark((function t(e,r,n){var a,c,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("register",e);case 3:return a=t.sent,c=s(s({},r.data),{},{title:"Register",current_page:"register"},a),i=f("register",c),t.abrupt("return",r.send(i));case 9:t.prev=9,t.t0=t.catch(0),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,r,n){return t.apply(this,arguments)}}(),P=function(){var t=u(o().mark((function t(e,r,n){var a,c,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("forgot-password",e);case 3:return a=t.sent,c=s(s({},r.data),{},{title:"forgot-password",current_page:"forgot-password"},a),i=f("forgot-password",c),t.abrupt("return",r.send(i));case 9:t.prev=9,t.t0=t.catch(0),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,r,n){return t.apply(this,arguments)}}(),S=function(){var t=u(o().mark((function t(e,r,n){var a,c,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h("reset-password",e);case 3:return a=t.sent,c=s(s({},r.data),{},{title:"reset-password",current_page:"reset-password"},a),i=f("reset-password",c),t.abrupt("return",r.send(i));case 9:t.prev=9,t.t0=t.catch(0),n(t.t0);case 12:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e,r,n){return t.apply(this,arguments)}}();t.exports={home:v,shop:y,collections:m,collection:g,search:b,product:w,cart:x,pages:k,contact:_,orderSuccess:O,login:j,signUp:E,resolveDataRequest:h,forgotPassword:P,resetPassword:S}},962:(t,e,r)=>{var n=r(228),o=n.errorResponse,a=n.developmentErrorResponse;t.exports=function(t,e,r){if(t.response){if(r.status(t.response.status),403===t.response.status)return r.status(404).send(o("404"));if(422===t.response.status)return r.status(403).send(o("403"));if(401===t.response.status&&"/password"!==e.originalUrl.split("?").shift())return r.status(200).redirect("/password")}var n="development"===process.env.APP_ENV?a(t):o("500");return r.status(t.status||500).send(n)}},760:(t,e,r)=>{var n=r(962);e.bootstrap=function(t,e,r){var o=t.headers["x-forwarded-proto"]||t.protocol;if("production"===process.env.APP_ENV&&"http"===o){var a="https://"+t.get("host")+t.originalUrl;return e.redirect(a)}e.errorHandler=n,r()}},792:t=>{function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}var r=function(t,r){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o={},a=0;a<Object.keys(t).length;a++){var s=Object.keys(t)[a];if("number"!==t[s]){if(e(r[s])!==t[s]){if(void 0===r[s]||""===r[s]){o[s]=s+" is required ".concat(n);continue}o[s]="Invalid ".concat(t[s]," value ").concat(r[s]," for ").concat(s)}}else try{r[s]=Number(r[s])}catch(e){o[s]="Invalid ".concat(t[s]," value ").concat(r[s]," for ").concat(s)}}return Object.keys(o).length>0?{status:"error",errors:o}:{status:"success"}},n=function(t,e,r){return"application/json"!==t.header("Accept")?(t.session.errors=JSON.stringify(r.errors),e.redirect(t.headers.referer)):e.status(400).json(r)};t.exports={addToCartValidation:function(t,e,o){try{var a=r({product_id:"number",quantity:"number"},t.body);if("error"==a.status)return n(t,e,a);o()}catch(t){o(t)}},updateCartValidation:function(t,e,o){try{var a=r({line:"number",quantity:"number"},t.body);if("error"==a.status)return n(t,e,a);o()}catch(t){o(t)}},applyDiscountValidation:function(t,e,o){try{var a=r({coupon:"string"},t.body);if("error"==a.status)return n(t,e,a);o()}catch(t){o(t)}},contactFormValidation:function(t,e,o){try{var a=r({name:"string",email:"string",message:"string"},t.body);if("error"==a.status)return n(t,e,a);o()}catch(t){o(t)}}}},671:(t,e,r)=>{var n=r(252).Router(),o=r(235),a=o.addToCart,s=o.updateCart,c=o.cartJson,i=o.applyDiscount,u=o.removeDiscount,p=o.quickView,f=o.newsletterSignup,l=o.contactForm,d=o.createProductReview,h=o.productsXMl,v=o.handleLogin,y=o.handleSignUp,m=o.handleForgotPassword,g=o.handleResetPassword,b=r(629),w=b.home,x=b.shop,k=b.collection,_=b.product,O=b.cart,j=b.pages,E=b.collections,P=b.search,S=b.contact,L=b.orderSuccess,N=b.login,T=b.signUp,q=b.forgotPassword,D=b.resetPassword,F=r(792),G=F.applyDiscountValidation,C=F.updateCartValidation,A=F.addToCartValidation,R=F.contactFormValidation;n.get("/",w),n.get("/shop",x),n.get("/collections",E),n.get("/collection/:slug",k),n.get("/search",P),n.get("/product/:slug",_),n.get("/pages/:name",j),n.get("/cart",O),n.get("/cart.json",c),n.get("/contact",S),n.get("/account/login",N),n.get("/account/register",T),n.get("/order/success/:order_no",L),n.get("/account/forgot-password",q),n.get("/account/reset-password/:id/:token",D),n.post("/cart/add",A,a),n.post("/cart/update",C,s),n.post("/discount/apply",G,i),n.post("/discount/remove",u),n.post("/product.json",p),n.post("/newsletter-signup",f),n.post("/contact",R,l),n.post("/reviews",d),n.post("/account/login",v),n.post("/account/register",y),n.post("/account/forgot-password",m),n.post("/account/reset-password/:id/:token",g),n.get("/datafeed/:channel",h),t.exports=n},268:t=>{"use strict";t.exports=require("body-parser")},898:t=>{"use strict";t.exports=require("cookie-parser")},691:t=>{"use strict";t.exports=require("cookie-session")},263:t=>{"use strict";t.exports=require("debug")},818:t=>{"use strict";t.exports=require("dotenv")},252:t=>{"use strict";t.exports=require("express")},96:t=>{"use strict";t.exports=require("morgan")},979:t=>{"use strict";t.exports=require("taojaa-storefront-helpers")},157:t=>{"use strict";t.exports=require("taojaa-storefront-helpers/src/api")},228:t=>{"use strict";t.exports=require("taojaa-storefront-helpers/src/errors")},292:t=>{"use strict";t.exports=require("taojaa-storefront-helpers/src/utils")},451:t=>{"use strict";t.exports=require("taojaa-storefront-middlewares")},773:t=>{"use strict";t.exports=require("taojaa-theme-engine")},896:t=>{"use strict";t.exports=require("fs")},611:t=>{"use strict";t.exports=require("http")},928:t=>{"use strict";t.exports=require("path")}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}var n=r(128),o=r(263)("store-front-service:server"),a=r(611),s=function(t){var e=parseInt(t,10);return isNaN(e)?t:e>=0&&e}(process.env.PORT||"3000");n.set("port",s);var c=a.createServer(n);c.listen(s),c.on("error",(function(t){if("listen"!==t.syscall)throw t;var e="string"==typeof s?"Pipe "+s:"Port "+s;switch(t.code){case"EACCES":console.error(e+" requires elevated privileges"),process.exit(1);break;case"EADDRINUSE":console.error(e+" is already in use"),process.exit(1);break;default:throw t}})),c.on("listening",(function(){var t=c.address(),e="string"==typeof t?"pipe "+t:"port "+t.port;o("Listening on "+e)}))})();